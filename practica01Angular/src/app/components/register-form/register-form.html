<div class="form-page">

 <!-- En todos está eñ display none para que solo se muestre el error cuándo éste
 se produzca   -->
  <form [formGroup]="userForm" (ngSubmit)="handleSubmit()">

    <!-- Comprobamos el Usuario -->
    <fieldset>
      <label for="username">Nombre de usuario</label>
      <input id="username" type="text" formControlName="username">
      @if(username.invalid && username.touched) {
        <p class="field-error">El nombre de usuario es obligatorio</p>
      } @else {
        <p class="field-error" style="display:none;"></p>
      }
    </fieldset>

    <!-- Verificación del email -->
    <fieldset>
      <label for="email">Correo electrónico</label>
      <input id="email" type="email" formControlName="email">
      @if(email.invalid && email.touched) {
        <p class="field-error">Ingresa un correo válido</p>
      } @else {
        <p class="field-error" style="display:none;"></p>
      }
    </fieldset>
    <!-- Verificación de contraseña -->
    <fieldset>
      <label for="password">Contraseña</label>
      <input id="password" type="password" formControlName="password">
      @if(password.invalid && password.touched) {
        <p class="field-error">La contraseña debe tener al menos 6 caracteres</p>
      } @else {
        <p class="field-error" style="display:none;"></p>
      }
    </fieldset>

    <!-- Para hacer la comprobación de que las dos contraseñas coinciden
    llama al notMatching para validar , solo serán validas si las dos 
    son true. -->

    <fieldset>
      <label for="confirmPassword">Confirmar contraseña</label>
      <input id="confirmPassword" type="password" formControlName="confirmPassword">
      @if(userForm.errors?.['notMatching'] && confirmPassword.touched) {
        <p class="field-error">Las contraseñas no coinciden</p>
      } @else {
        <p class="field-error" style="display:none;"></p>
      }
    </fieldset>

    <button type="submit" [disabled]="userForm.invalid">Registrarse</button>
  </form>

<!-- Para que tenga utilidad el formulario de abajo cada usuario registrado 
se mostrará aquí:   -->
  <div class="users-registered">
    <h2>Usuarios registrados</h2>

    @if (registeredUsers.length > 0) {
      @for (user of registeredUsers; track $index) {
        <div class="user-card">
          <p><strong>Usuario:</strong> {{ user.username }}</p>
          <p><strong>Email:</strong> {{ user.email }}</p>
        </div>
      }
    } @else {
      <p class="empty-msg">Todavía no hay usuarios registrados</p>
    }
  </div>

</div>
